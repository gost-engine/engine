name: CI
on: [push, pull_request]

env:
    OPENSSL_BRANCH: OpenSSL_1_1_1r

jobs:
    gcc-openssl-111r:
        runs-on: ubuntu-20.04
        steps:
            - uses: actions/checkout@v2
            - run: .github/before_script.sh
            - run: .github/script.sh

    clang-openssl-111r:
        runs-on: ubuntu-20.04
        env:
            CC: clang
        steps:
            - uses: actions/checkout@v2
            - run: .github/before_script.sh
            - run: .github/script.sh

    gcc-asan-openssl-111r:
        runs-on: ubuntu-20.04
        env:
            OPENSSL_BRANCH: OpenSSL_1_1_1r
            ASAN: -DASAN=1
        steps:
            - uses: actions/checkout@v2
            - run: .github/before_script.sh
            - run: .github/script.sh

    gcc-openssl-111r-x86:
        runs-on: ubuntu-20.04
        env:
            CFLAGS: -m32
            LDFLAGS: -m32
            SETARCH: "setarch i386"
            APT_INSTALL: gcc-multilib
        steps:
            - uses: actions/checkout@v2
            - run: .github/before_script.sh
            - run: .github/script.sh

